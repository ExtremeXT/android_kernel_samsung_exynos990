# ExtremeKernel config file
# This file gets merged with the device-specific defconfig on kernel compilation
# Kernel defconfigs are left stock with minimal edits while this file includes all of the major modifications done to the kernel config

# Set custom kernel version
CONFIG_LOCALVERSION="-ExtremeKernel-v4.6"
# CONFIG_LOCALVERSION_AUTO is not set
CONFIG_F2FS_REPORT_FAKE_KERNEL_VERSION=y
CONFIG_F2FS_FAKE_KERNEL_RELEASE="4.19.87-ExtremeKernel-v4.6"
CONFIG_F2FS_FAKE_KERNEL_VERSION="#1 SMP PREEMPT Sat May 25 13:17:45 EEST 2024"

# BPF add-ons for newer Android versions
CONFIG_BPF_JIT=y
CONFIG_BPF_JIT_ALWAYS_ON=y
CONFIG_DM_SNAPSHOT=y
CONFIG_DUMMY=y

# Enable BinderFS driver
CONFIG_ANDROID_BINDERFS=y

# Enable CGroup support and throttling for block devices
CONFIG_BLK_CGROUP=y
CONFIG_CFQ_GROUP_IOSCHED=y
CONFIG_BFQ_GROUP_IOSCHED=y
CONFIG_BLK_DEV_THROTTLING=y
CONFIG_BLK_DEV_THROTTLING_LOW=y

# Optimize kernel for performance instead of size
# CONFIG_CC_OPTIMIZE_FOR_SIZE is not set
CONFIG_CC_OPTIMIZE_FOR_PERFORMANCE=y
CONFIG_TOOLS_SUPPORT_RELR=y
CONFIG_ARCH_HAS_RELR=y
CONFIG_RELR=y
CONFIG_LLVM_POLLY=y
CONFIG_LLVM_DFA_JUMP_THREAD=y
CONFIG_LLVM_MLGO_REGISTER=y

# Disable CGroup pressure (https://github.com/aosp-mirror/kernel_common/commit/cda79c474cf1d2fc622c265fea75d43ff840afa6)
# And set androidboot.boot_devices (https://github.com/fcuzzocrea/android_kernel_samsung_universal9830/commit/f004bf11b45c81adab78a49357f103f645e5c11e)
CONFIG_CMDLINE="cgroup_disable=pressure androidboot.boot_devices=13100000.ufs"
CONFIG_CMDLINE_EXTEND=y

# Disable unapplicable CPU vulnerability mitigations
# CONFIG_ARM64_SSBD is not set
# CONFIG_MITIGATE_SPECTRE_BRANCH_HISTORY is not set

# Set CPU core masks
CONFIG_LITTLE_CPU_MASK=15
CONFIG_BIG_CPU_MASK=48
CONFIG_PRIME_CPU_MASK=192

# Disable reundant debugging
# CONFIG_SLUB_DEBUG is not set
# CONFIG_KPROBES is not set
# CONFIG_GATOR is not set
# CONFIG_F2FS_SEC_BLOCK_OPERATIONS_DEBUG is not set
# CONFIG_SEC_DEBUG_FREQ is not set
# CONFIG_UFS_DATA_LOG is not set
# CONFIG_UFS_DATA_LOG_MAGIC_CODE is not set

# KernelSU
# CONFIG_KSU is not set
# CONFIG_KSU_DEBUG is not set

# Spoof CMDLine properties for Play Integrity API / SafetyNet attestation
CONFIG_PROC_SPOOF_CMDLINE=y

# Enable TEO and disable MENU
CONFIG_CPU_IDLE_GOV_TEO=y
# CONFIG_CPU_IDLE_GOV_MENU is not set

# Set SCHEDUTIL governor as default
CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL=y
# CONFIG_CPU_FREQ_DEFAULT_GOV_ENERGYSTEP is not set

# Enable misc kernel features
CONFIG_CPU_FREQ_GOV_POWERSAVE=y
CONFIG_CPU_FREQ_GOV_USERSPACE=y
CONFIG_CPU_FREQ_GOV_ONDEMAND=y
CONFIG_CPU_FREQ_GOV_CONSERVATIVE=y
CONFIG_TCP_CONG_WESTWOOD=y
CONFIG_TCP_CONG_HTCP=y
CONFIG_IOSCHED_BFQ=y
CONFIG_CRYPTO_LZ4=y
CONFIG_CRYPTO_ZSTD=y
CONFIG_IP_NF_TARGET_TTL=y
CONFIG_WIREGUARD=y
CONFIG_BOEFFLA_WL_BLOCKER=y
CONFIG_INCREMENTAL_FS=y

# Enable EroFS
CONFIG_EROFS_FS=y
CONFIG_EROFS_FS_PCPU_KTHREAD=y
CONFIG_EROFS_FS_PCPU_KTHREAD_HIPRI=y

# Enable power efficient workqueues
CONFIG_WQ_POWER_EFFICIENT_DEFAULT=y

# Set the minimum block dev loop count to 16 (https://github.com/aosp-mirror/kernel_common/commit/dd5d3e98d0ae393120dfe412cf6b4e5363cec920)
CONFIG_BLK_DEV_LOOP_MIN_COUNT=16

# Treat build warnings as errors
CONFIG_CC_WERROR=y

# Force SELinux to Enforcing
CONFIG_SECURITY_SELINUX_ALWAYS_ENFORCE=y
# CONFIG_SECURITY_SELINUX_ALWAYS_PERMISSIVE is not set

# EOF
